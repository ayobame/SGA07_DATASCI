View(AllInvestmentsDf)
df <- left_join(df, AllDemographicsDf, by = 'CUSTOMER_UNIQUE_ID')
glimpse(df)
glimpse(df)
nrow(AllDemographicsDf)
ncol(AllDemographicsDf)
ncol(df)
df <- left_join(df, AllInvestmentsDf,by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT') )
View(df)
View(AllLoansDf)
df <- left_join(df, AllLoansDf, by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT'))
AllLoansDf <- read.csv('all_loans.csv', stringsAsFactors = T)
View(AllLoansDf)
df <- left_join(df, AllLoansDf, by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT'))
install.packages("devtools", dependencies = TRUE)
devtools::install_github("krlmlr/ulimit")
memory.size()
memory.limit()
memory.profile()
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr)
df <- left_join(df, AllLoansDf, by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT'))
memory.limit(size=2500)
memory.limit(size=16000)
df <- left_join(df, AllLoansDf, by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT'))
memory.limit(size=50000)
df <- left_join(df, AllLoansDf, by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT'))
memory.limit(8000)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr)
AllAccountsDf
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr)
AllAccountsDf <- read.csv('all_accounts.csv')
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, DBI, odbc, dbplyr)
con <- dbConnect(odbc::odbc(), "Oracle DB")
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, DBI, odbc, dbplyr)
con <- dbConnect(odbc::odbc(), "Oracle DB")
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, DBI, odbc, dbplyr)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr)
AllAccountsDf <- read.csv('all_accounts.csv')
AllBalancesDf <- read.csv('all_balances.csv')
AllDemographicsDf <- read.table('all_demographics.csv', stringsAsFactors = FALSE, sep = '|', header = TRUE)
AllInvestmentsDf <- read.csv('all_investments.csv')
AllLoans <- read.csv('all_loans.csv', stringsAsFactors = T)
AllLoansApplication <- read.csv('all_loans_application.csv')
AllTransactionsDigital <- read.csv('all_transactions_digital.csv')
BureauScore <- read.csv('bureau_score.csv')
# glimpse(AllAccountsDf)
# str(AllAccountsDf)
# str(AllBalancesDf)
# AllBalancesDf$VAL_DT <- mdy( as.character(AllBalancesDf$VAL_DT) )
# str(AllDemographicsDf)
AllLoans <- read.csv('all_loans.csv', stringsAsFactors = T) [ -C(PRODUCT_NAME, CURRENCY)]
AllLoans <- read.csv('all_loans.csv', stringsAsFactors = T) [ -C('PRODUCT_NAME', 'CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', sep = ',') [ -C('PRODUCT_NAME', 'CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', sep = ',',stringsAsFactors = T, ) [ -C('PRODUCT_NAME','CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', sep = ',',stringsAsFactors = T, ) [ ~C('PRODUCT_NAME','CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', sep = ',',stringsAsFactors = T, ) [ , -C('PRODUCT_NAME','CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T, ) [ , C('PRODUCT_NAME','CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T, )[ , C('PRODUCT_NAME','CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T )[ , C('PRODUCT_NAME','CURRENCY')]
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T )
AllLoans <- AllLoans([-c('PRODUCT_NAME','CURRENCY')])
AllLoans <- AllLoans([,-c('PRODUCT_NAME','CURRENCY')])
AllLoans <- [,-c('PRODUCT_NAME','CURRENCY')]
AllLoans <- ,-c('PRODUCT_NAME','CURRENCY')
AllLoans <- (,-c('PRODUCT_NAME','CURRENCY'))
AllLoans <- -c('PRODUCT_NAME','CURRENCY')
drop(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY)
AllLoans<- drop (c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY))
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T )
AllLoans<- droplevels.data.frame(c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY))
View(AllLoans)
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T )
AllLoans<- ( ,-c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY))
AllLoans<- ( , c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY))
AllLoans<-  -c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY)
AllLoans<-  -c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY)
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T )
AllLoans <- -c('PRODUCT_NAME','CURRENCY')
AllLoans <- c('PRODUCT_NAME','CURRENCY')
data.frame(AllLoans)
AllLoans
AllLoans <- read.csv(file = 'all_loans.csv', stringsAsFactors = T )
AllLoans<-  c(AllLoans$PRODUCT_NAME,AllLoans$CURRENCY)
AllLoans
data.frame(AllLoans)
View(AllLoans)
AllLoans <- read.csv('all_loans.csv', stringsAsFactors = T )
View(AllLoans)
AllLoans <- read.csv::fread ('all_loans.csv', stringsAsFactors = T, drop(C('PRODUCT_NAME','CURRENCY')) )
AllLoans <- read.table::fread ('all_loans.csv', stringsAsFactors = T, drop(C('PRODUCT_NAME','CURRENCY')) )
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr)
AllLoans <- read.table::fread (
'all_loans.csv', stringsAsFactors = T, drop = 'PRODUCT_NAME')
AllLoans <- fread(
'all_loans.csv', stringsAsFactors = T, drop = c('PRODUCT_NAME', 'CURRENCY'))
View(AllLoans)
View(AllLoans)
AllLoansApplication <- read.csv('all_loans_application.csv')
View(AllLoansApplication)
View(AllLoans)
View(AllLoans)
View(AllTransactionsDigital)
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID), FUN=sum)
View(ATdf)
View(ATdf)
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= C(AllTransactionsDigital$CUSTOMER_UNIQUE_ID, AllTransactionsDigital$MASKED_ACCT)), FUN=sum)
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID, AllTransactionsDigital$MASKED_ACCT), FUN=sum)
View(ATdf)
AllTransactionsDigital <- read.csv('all_transactions_digital.csv',select=c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select=c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select.list() = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select.list = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select =('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', select =c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- read.csv('all_transactions_digital.csv', drop=c('TRN_REF_NO','AC_CCY','DRCR_IND','TRN_CODE','FCY_AMOUNT','EXCH_RATE','TRN_DT'))
AllTransactionsDigital <- fread('all_transactions_digital.csv', select = =c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
AllTransactionsDigital <- fread('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID, AllTransactionsDigital$MASKED_ACCT), FUN=sum)
View(AllTransactionsDigital)
ATdf$MASKED_ACCT <- ATdf$Group.2
drop(ATdf$Group.2)
ATdf <- drop(ATdf$Group.2)
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID, AllTransactionsDigital$MASKED_ACCT), FUN=sum)
ATdf$MASKED_ACCT <- ATdf$Group.2
ATdf <- drop(ATdf$Group.2)
AllTransactionsDigital <- fread('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID, MASKED_ACCT=AllTransactionsDigital$MASKED_ACCT), FUN=sum)
View(ATdf)
names(ATdf)[3] <- "AGG_LCY_AMOUNT"
View(AllLoansApplication)
### All loans application
AllLoansApplication <- fread('all_loans_application.csv', drop = c('OFFERID','APPLICATION_STATUS', 'MODULE'))
View(AllLoansApplication)
View(AllTransactionsDigital)
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID), FUN=sum)
View(ATdf)
names(ATdf)[2] <- "AGG_LCY_AMOUNT"
View(AllLoansApplication)
View(AllLoans)
ALdf <- aggregate(AllLoans$AMOUNT_FINANCED, by = list(CUSTOMER_UNIQUE_ID = AllLoans$CUSTOMER_UNIQUE_ID), FUN = sum)
View(ATdf)
View(ATdf)
Alloansdf <- aggregate(AllLoans$AMOUNT_FINANCED, by = list(CUSTOMER_UNIQUE_ID = AllLoans$CUSTOMER_UNIQUE_ID), FUN = sum)
View(AllLoansApplication)
### All loans application
AllLoansApplication <- fread('all_loans_application.csv', drop = c('OFFERID','APPLICATION_STATUS', 'MODULE'))
AllLoansAppdf <- mean(AllLoansApplication$INCR_ALLOWED, by = list(CUSTOMER_UNIQUE_ID = AllLoansApplication$CUSTOMER_UNIQUE_ID), FUN = sum))
AllLoansAppdf <- mean(AllLoansApplication$INCR_ALLOWED, by = list(CUSTOMER_UNIQUE_ID =AllLoansApplication$CUSTOMER_UNIQUE_ID), FUN = sum)
AllLoansAppdf <- max(AllLoansApplication$INCR_ALLOWED, by = list(CUSTOMER_UNIQUE_ID =AllLoansApplication$CUSTOMER_UNIQUE_ID), FUN = sum)
AllLoansAppdf <- aggregate(AllLoansApplication$INCR_ALLOWED, by = list(CUSTOMER_UNIQUE_ID =AllLoansApplication$CUSTOMER_UNIQUE_ID), FUN = sum)
View(AllLoansAppdf)
View(AllLoansApplication)
AllLoansAppdf <- AllLoansApplication %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(Date == max(DATE_OF_APPLY))
AllLoansAppdf <- AllLoansApplication %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(DATE_OF_APPLY
== max(DATE_OF_APPLY))
View(AllLoansAppdf)
AllLoansAppdf1 <-  group_by(AllLoansApplication$CUSTOMER_UNIQUE_ID) filter(AllLoansApplication$DATE_OF_APPLY
AllLoansAppdf1 <-  group_by(AllLoansApplication$CUSTOMER_UNIQUE_ID) filter('AllLoansApplication$DATE_OF_APPLY'== max(AllLoansApplication$DATE_OF_APPLY))
AllLoansAppdf1 <-  group_by(AllLoansApplication$CUSTOMER_UNIQUE_ID) filter=('AllLoansApplication$DATE_OF_APPLY'== max(AllLoansApplication$DATE_OF_APPLY))
AllLoansAppdf1 <-  group_by(AllLoansApplication$CUSTOMER_UNIQUE_ID) Filter('AllLoansApplication$DATE_OF_APPLY'== max(AllLoansApplication$DATE_OF_APPLY))
install.packages(c("nycflights13", "gapminder", "Lahman"))
ggplot(data = mpg) + geom_point(mapping = aes(x = displ, y = hwy))
View(Alloansdf)
View(AllLoans)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dply)
### All loans df
AllLoans <- fread('all_loans.csv', stringsAsFactors = T, drop = c('PRODUCT_NAME', 'CURRENCY'))
View(AllLoans)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE== max(DATE_OF_APPLY)))
### All loans df
AllLoans <- fread('all_loans.csv', stringsAsFactors = T, drop = c('PRODUCT_NAME', 'CURRENCY'))
View(AllLoans)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE==DATE_OF_APPLY))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE==BOOK_DATE))
View(Alloansdf)
View(AllLoansdf)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
View(AllLoansAppdf)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
### All loans df
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
View(AllLoans)
View(Alloansdf)
View(AllLoansdf)
### All transaction digital imported in
AllTransactionsDigital <- fread('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID), FUN=sum)
View(ATdf)
### All Accounts
AllAccountsDf <- read.csv('all_accounts.csv')
View(AllAccountsDf)
View(AllAccountsDf)
AllBalancesDf <- read.csv('all_balances.csv')
View(AllBalancesDf)
#### All balance aggregate
albaggdf <- aggregate( AllBalancesDf$BAL, by=list(CUSTOMER_UNIQUE_ID= AllBalancesDf$CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT = AllBalancesDf$MASKED_ACCOUNT ), FUN=sum)
#### All demographics
AllDemographicsDf <- read.table('all_demographics.csv', stringsAsFactors = FALSE, sep = '|', header = TRUE)
### All demographics
AllDemographics <- read.table('all_demographics.csv', stringsAsFactors = FALSE, sep = '|', header = TRUE)
View(AllDemographics)
colnames(AllDemographics)
View(BureauScore)
View(AllInvestmentsDf)
View(AllBalancesDf)
View(AllDemographics)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dply)
AllDemographics <- fread('all_demographics.csv',  stringsAsFactors = FALSE, sep = '|', header = TRUE, select = c('CUSTOMER_UNIQUE_ID', 'CUSTOMER_TYPE','MARITAL_STATUS','DATE_OF_BIRTH') )
View(AllDemographics)
### All demographics
AllDemographics <- fread('all_demographics.csv',  stringsAsFactors = FALSE, sep = '|', header = TRUE, select = c('CUSTOMER_UNIQUE_ID', 'CUSTOMER_TYPE','MARITAL_STATUS','DATE_OF_BIRTH', 'SEX') )
View(AllDemographics)
View(AllInvestmentsDf)
### All balance
AllBalancesDf <-fread('all_balances.csv')
#### All balance aggregate
AllBalancesDf <- aggregate( AllBalancesDf$BAL, by=list(CUSTOMER_UNIQUE_ID = AllBalancesDf$CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT = AllBalancesDf$MASKED_ACCOUNT ), FUN=sum)
View(AllBalancesDf)
View(AllBalancesDf)
### All balance
AllBalancesDf <-fread('all_balances.csv')
#### All balance aggregate
AllBalancesDf <- aggregate( AllBalancesDf$BAL, by=list(CUSTOMER_UNIQUE_ID = AllBalancesDf$CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT = AllBalancesDf$MASKED_ACCOUNT ), FUN=sum)
colnames(AllBalancesDf)
names(AllBalancesDf)[3] <- 'AggBal'
View(ATdf)
---
title: "GroupTask"
author: "Group1"
date: "20/02/2020"
output: pdf_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dply)
```
## Group Task 1
###The goal of the group task is to apply data science tools and techniques to improve a lending business.
<!-- The two major use cases of the tasks include; Build a predictive model that can -->
<!-- classify a loan application as performing or non-performing Develop an -->
<!-- alternative credit scoring framework -->
<!-- Key areas to divide responsibilities: Data Visualisation, Data Modelling, Data -->
<!-- Preprocessing -->
```{r}
### All loans df
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
### All loans application
AllLoansApplication <- fread('all_loans_application.csv', drop = c('OFFERID','APPLICATION_STATUS', 'MODULE'))
AllLoansAppdf <- AllLoansApplication %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(DATE_OF_APPLY
== max(DATE_OF_APPLY))
### All transaction digital imported in
AllTransactionsDigital <- fread('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
#### AN aggregate of digital transactions
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID), FUN=sum)
### All Accounts
AllAccountsDf <- read.csv('all_accounts.csv')
### All balance
AllBalancesDf <-fread('all_balances.csv')
#### All balance aggregate
AllBalancesDf <- aggregate( AllBalancesDf$BAL, by=list(CUSTOMER_UNIQUE_ID = AllBalancesDf$CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT = AllBalancesDf$MASKED_ACCOUNT ), FUN=sum)
names(AllBalancesDf)[3] <- 'AggBal'
### All demographics
AllDemographics <- fread('all_demographics.csv',  stringsAsFactors = FALSE, sep = '|', header = TRUE, select = c('CUSTOMER_UNIQUE_ID', 'CUSTOMER_TYPE','MARITAL_STATUS','DATE_OF_BIRTH', 'SEX') )
AllInvestmentsDf <- read.csv('all_investments.csv')
BureauScore <- read.csv('bureau_score.csv')
# ddply(AllAccountsDf, "Species", summarise,
#   wmn = weighted.mean(Sepal.Length, Petal.Length),
#   mn = mean(Sepal.Length))
# glimpse(AllAccountsDf)
# str(AllAccountsDf)
# str(AllBalancesDf)
# AllBalancesDf$VAL_DT <- mdy( as.character(AllBalancesDf$VAL_DT) )
# str(AllDemographicsDf)
```
```{r}
df <- left_join(AllAccountsDf, AllBalancesDf, by = c('MASKED_ACCOUNT','CUSTOMER_UNIQUE_ID'))
df <- left_join(df, AllDemographicsDf, by = 'CUSTOMER_UNIQUE_ID')
df <- left_join(df, AllInvestmentsDf,by = c('CUSTOMER_UNIQUE_ID','MASKED_ACCOUNT') )
glimpse(df)
ncol(df)
```
we have 29,057
```{sql connection= con,envir = globalenv(), output.var='AllBalancesDf1'}
SELECT *from AllBalancedf
```
```{r setup, include=FALSE}
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dply)
### All loans df
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
### All loans application
AllLoansApplication <- fread('all_loans_application.csv', drop = c('OFFERID','APPLICATION_STATUS', 'MODULE'))
AllLoansAppdf <- AllLoansApplication %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(DATE_OF_APPLY
== max(DATE_OF_APPLY))
### All transaction digital imported in
AllTransactionsDigital <- fread('all_transactions_digital.csv', select = c('CUSTOMER_UNIQUE_ID','MASKED_ACCT','LCY_AMOUNT'))
#### AN aggregate of digital transactions
ATdf <- aggregate( AllTransactionsDigital$LCY_AMOUNT, by=list(CUSTOMER_UNIQUE_ID= AllTransactionsDigital$CUSTOMER_UNIQUE_ID), FUN=sum)
### All Accounts
AllAccountsDf <- read.csv('all_accounts.csv')
### All balance
AllBalancesDf <-fread('all_balances.csv')
#### All balance aggregate
AllBalancesDf <- aggregate( AllBalancesDf$BAL, by=list(CUSTOMER_UNIQUE_ID = AllBalancesDf$CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT = AllBalancesDf$MASKED_ACCOUNT ), FUN=sum)
names(AllBalancesDf)[3] <- 'AggBal'
### All demographics
AllDemographics <- fread('all_demographics.csv',  stringsAsFactors = FALSE, sep = '|', header = TRUE, select = c('CUSTOMER_UNIQUE_ID', 'CUSTOMER_TYPE','MARITAL_STATUS','DATE_OF_BIRTH', 'SEX') )
AllInvestmentsDf <- read.csv('all_investments.csv')
BureauScore <- read.csv('bureau_score.csv')
# ddply(AllAccountsDf, "Species", summarise,
#   wmn = weighted.mean(Sepal.Length, Petal.Length),
#   mn = mean(Sepal.Length))
# glimpse(AllAccountsDf)
# str(AllAccountsDf)
# str(AllBalancesDf)
# AllBalancesDf$VAL_DT <- mdy( as.character(AllBalancesDf$VAL_DT) )
# str(AllDemographicsDf)
View(BureauScore)
212946347 / 4976
View(AllLoansdf)
View(AllLoans)
View(AllLoansAppdf)
View(BureauScore)
BureauScore <- fread('bureau_score.csv', drop = c('CUSTOMER_TYPE', 'BUREA_SCORE', 'CPO','LOAN_CT',))
BureauScore <- fread('bureau_score.csv', drop = c('CUSTOMER_TYPE', 'BUREAU_SCORE', 'CPO','LOAN_CT'))
View(BureauScore)
BSDF <- aggregate( BureauScore$APPROVED_AMT, by=list(CUSTOMER_UNIQUE_ID= BureauScore$CUSTOMER_UNIQUE_ID), FUN=sum)
View(BSDF)
View(AllTransactionsDigital)
BSDF <- aggregate( BureauScore$APPROVED_AMT, BureauScore$APPROVED_AMT by=list(CUSTOMER_UNIQUE_ID= BureauScore$CUSTOMER_UNIQUE_ID), FUN=sum)
BSDF <- aggregate( BureauScore$APPROVED_AMT, BureauScore$APPROVED_AMT, by=list(CUSTOMER_UNIQUE_ID= BureauScore$CUSTOMER_UNIQUE_ID), FUN=sum)
View(BSDF)
View(BSDF)
View(BureauScore)
BSDF <- aggregate( BureauScore$APPROVED_AMT, by=list(CUSTOMER_UNIQUE_ID= BureauScore$CUSTOMER_UNIQUE_ID, APPROVE_AMT), FUN=sum)
BSDF <- aggregate( BureauScore$APPROVED_AMT, by=list(CUSTOMER_UNIQUE_ID= BureauScore$CUSTOMER_UNIQUE_ID, APPROVE_AMT= BureauScore$APPROVED_AMT), FUN=sum)
View(BSDF)
View(BureauScore)
unique(BureauScore$CUSTOMER_UNIQUE_ID)
length(unique(BureauScore$CUSTOMER_UNIQUE_ID))
length(unique(BureauScore$CUSTOMER_UNIQUE_ID))
View(ALdf)
View(AllAccountsDf)
length(unique(AllAccountsDf$CUSTOMER_UNIQUE_ID))
length(unique(BureauScore$CUSTOMER_UNIQUE_ID))
length(unique(AllLoansdf$CUSTOMER_UNIQUE_ID))
length(unique(AllTransactionsDigital$CUSTOMER_UNIQUE_ID))
length(unique(BureauScore$CUSTOMER_UNIQUE_ID))
View(AllDemographics)
mtcars
plot(mtcars)
plot(mtcars$mpg, mtcars$cyl)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dply)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, tidyr)
setwd("C:/Users/Awhy/SGA07_DATASCI/GroupProject")
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>% summarise(cases = sum(cases))
View(AllLoans)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>% summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED))
View(AllLoansdf)
View(AllLoans)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED)) %>%
ACCOUNT_STATUS
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED))
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED))
AllLoansdff <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID) %>% filter(BOOK_DATE == max(BOOK_DATE))
View(AllLoansdf)
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED)) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED))
View(AllLoansdf)
#check fir columns with missing values
na.cols <- which(colSums(is.na(AllLoansdf)) > 0)
na.cols <- sort(colSums(sapply(AllLoansdf[na.cols], is.na)), decreasing = TRUE)
na.cols <- sort(colSums(sapply(AllLoansdf[na.cols], is.na)), decreasing = TRUE)
na.cols <- sort(colSums(sapply(AllLoans[na.cols], is.na)), decreasing = TRUE)
#check fir columns with missing values
na.cols <- which(colSums(is.na(AllLoans)) > 0)
#check fir columns with missing values
na.cols <- which(colSums(is.na(AllLoans)) > 0)
na.cols <- sort(colSums(sapply(AllLoans[na.cols], is.na)), decreasing = TRUE)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, corrplot, cowplot)
#check fir columns with missing values
na.cols <- which(colSums(is.na(AllLoans)) > 0)
na.cols <- sort(colSums(sapply(AllLoans[na.cols], is.na)), decreasing = TRUE)
paste('There are', length(na.cols), 'columns with missing values')
na.cols
###### MISSING VALUES
AllLoansdf[AllLoansdf== ""] <- NA
#check fir columns with missing values
na.cols <- which(colSums(is.na(AllLoansdf)) > 0)
na.cols <- sort(colSums(sapply(AllLoansdf[na.cols], is.na)), decreasing = TRUE)
paste('There are', length(na.cols), 'columns with missing values')
na.cols
na.cols <- sort(colSums(sapply(AllLoansdf[na.cols], is.na)), decreasing = TRUE)
AllLoans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'CURRENCY'))
AllLoansdf <- AllLoans %>% group_by(CUSTOMER_UNIQUE_ID, MASKED_ACCOUNT) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED)) %>%
summarise(AMOUNT_FINANCED = sum(AMOUNT_FINANCED))
View(AllLoansdff)
View(AllLoansdf)
View(AllLoansdff)
View(AllLoansdf)
View(AllLoansdff)
View(AllLoans)
AllLoansagg <- AllLoans %>% aggregate(by = CUSTOMER_ID)
AllLoansagg <- AllLoans %>% aggregate(by = CUSTOMER_ID,FUN=sum)
View(AllLoans)
AllLoansagg <- AllLoans %>% aggregate(by = CUSTOMER_UNIQUE_ID,FUN=sum)
AllLoansagg <- AllLoans %>% aggregate(by = 'CUSTOMER_UNIQUE_ID',FUN=sum)
AllLoansagg <- AllLoans %>% aggregate.data.frame (by = 'CUSTOMER_UNIQUE_ID',FUN=sum)
AllLoansagg <- AllLoans %>% aggregate.data.frame (by = C('CUSTOMER_UNIQUE_ID'),FUN=sum)
AllLoansagg <- AllLoans %>% aggregate(by = C('CUSTOMER_UNIQUE_ID'),FUN=sum)
AllLoansagg <- AllLoans %>% aggregate(by = list('CUSTOMER_UNIQUE_ID'),FUN=sum)
AllLoansagg <- AllLoans %>% aggregate(by = list(CUSTOMER_UNIQUE_ID = CUSTOMER_UNIQUE_ID),FUN=sum)
AllLoansagg <- AllLoans %>% aggregate(by = list(CUSTOMER_UNIQUE_ID = 'CUSTOMER_UNIQUE_ID'),FUN=sum)
AllLoansagg <- AllLoans %>% aggregate(by = list(CUSTOMER_UNIQUE_ID = 'CUSTOMER_UNIQUE_ID'),FUN=sum())
AllLoansagg <- AllLoans %>% aggregate(by = list(CUSTOMER_UNIQUE_ID = CUSTOMER_UNIQUE_ID),FUN=sum)
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, corrplot, cowplot)
Loans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME'))
View(Loans)
Loans = Loans[-c(PRODUCT_CODE=='SCAS', PRODUCT_CODE == 'STLV', PRODUCT_CODE=='STLP', PRODUCT_CODE=='STLM'),]
Loans = Loans[-c(PRODUCT_CODE=='SCAS', PRODUCT_CODE == 'STLV', PRODUCT_CODE=='STLP', PRODUCT_CODE=='STLM'),]
Loans = Loans[-c(Loans$PRODUCT_CODE =='SCAS', Loans$PRODUCT_CODE == 'STLV',
Loans$PRODUCT_CODE=='STLP', Loans$PRODUCT_CODE=='STLM'),]
Loans = Loans[!(Loans$PRODUCT_CODE =='SCAS', Loans$PRODUCT_CODE == 'STLV',
Loans$PRODUCT_CODE=='STLP', Loans$PRODUCT_CODE=='STLM'),]
### Importing all loans data set
Loans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME'))
Loans = Loans[!(Loans$PRODUCT_CODE =='SCAS', Loans$PRODUCT_CODE == 'STLV', Loans$PRODUCT_CODE=='STLP', Loans$PRODUCT_CODE=='STLM'),]
Loans <- [!(Loans$PRODUCT_CODE == 'SCAS'),]
Loans <- Loans[!(Loans$PRODUCT_CODE == 'SCAS'),]
### Importing all loans data set
Loans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME'))
Loans <- Loans[!(Loans$PRODUCT_CODE == 'SCAS' OR Loans$PRODUCT_CODE == 'STLV' OR
Loans$PRODUCT_CODE=='STLP'or Loans$PRODUCT_CODE=='STLM')]
View(Loans)
Loans %>% group_by(PRODUCT_CODE) %>%
summarise(count = n()) %>%
arrange(desc(count))
Loanpc <- Loans %>% group_by(PRODUCT_CODE) %>%
summarise(count = n()) %>%
arrange(desc(count))
view(Loanpc)
plot(Loanpc)
Loanas <- Loans %>% group_by(ACCOUNT_STATUS) %>%
summarise(count = n()) %>%
arrange(desc(count))
View(Loanas)
View(Loanas)
View(Loanpc)
View(Loans)
### Importing all loans data set
Loans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'LOAN_REF'))
### Importing all loans data set
Loans <- fread('all_loans.csv', stringsAsFactors = F, drop = c('PRODUCT_NAME', 'LOAN_REF', 'CURRENCY'))
select(Loans,-ends_with("SCAS","STLV","STLP", "STLM"))
select(Loans$PRODUCT_CODE,-ends_with("SCAS","STLV","STLP", "STLM"))
select(Loans$PRODUCT_CODE,-c("SCAS","STLV","STLP", "STLM"))
ggplot2(Loans,aes(points,AMOUNT_FINANCED))+geom_point() + geom_smooth()
library(pacman)
pacman::p_load(data.table,tidyverse,lubridate,ggplot2, dplyr, corrplot, cowplot)
ggplot2(Loans,aes(points,AMOUNT_FINANCED))+geom_point() + geom_smooth()
ggplot(Loans,aes(points,AMOUNT_FINANCED))+geom_point() + geom_smooth()
ggplot(Loans,aes(points,'AMOUNT_FINANCED'))+geom_point() + geom_smooth()
plot(Loans$PRODUCT_CODE)
plot(Loanas)
view(Loanas)
plot(Loanas$ACCOUNT_STATUS, Loanas$count)
plot(Loanas$ACCOUNT_STATUS, Loanas$count, xlab = 'Account',ylab = 'count')
